/*
* Aspera Web JavaScript API
* Revision date: 02/05/2015
*
* http://www.asperasoft.com/
* 
* $Id: asperaweb-2.js
*/
"use strict";if(typeof AW=="undefined")var AW={};AW.utils={isLogging:function(){var a=window.console||"";if("MozAppearance"in document.documentElement.style&&/Firefox\/3./.test(navigator.userAgent))return!1;return a.log||!window.attachEvent?!0:!1}(),logger:function(a){this.isLogging&&console.log(a)},versionLessThan:function(a,b){var c=function(a){var b=a.split("."),c=[];for(var d=0;d<b.length;d++)isNaN(parseInt(b[d]))&&AW.utils.logger("Warning: Version contains non-numbers"),c.push(parseInt(b[d],10));return c},d=c(a),e=c(b),f;for(f=0;f<Math.min(d.length,e.length);f++){if(d[f]<e[f])return!0;if(d[f]>e[f])return!1}return!1},randomString:function(a){var b,c;b="",a>200&&(a=200),a=a||5,c="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789";for(var d=0;d<a;d++)b+=c.charAt(Math.floor(Math.random()*c.length));return b},localize:function(a,b){var c;b=b||"en-US";if(typeof AW.localize=="undefined")return a;if(typeof AW.localize[b]=="undefined")try{return AW.localize[b.substring(0,2)][a]}catch(d){return AW.localize["en-US"][a]||a}c=AW.localize[b][a];if(typeof c=="undefined")return AW.localize["en-US"][a]||a;return c},joinPaths:function(){var a,b;a=Array.prototype.slice.call(arguments),b=a.pop();for(var c=0,d=a.length;c<d;c++)a[c]=a[c].replace(/^\/*/,""),a[c]=a[c].replace(/\/*$/,"");b=b.replace(/^\/*/,"");return a.join("/")+"/"+b},browser:{is:{ff:navigator.userAgent.indexOf("Firefox/")!==-1,ie:!!navigator.userAgent.match(/Trident.*rv/)||Boolean(document.all&&!window.opera),lteIe6:function(){var a=function(){try{return parseInt(navigator.userAgent.match(/MSIE (\d+)/)[1])<=6&&!window.opera}catch(a){return!1}};return a()}(),ie7:function(){var a=function(){try{return parseInt(navigator.userAgent.match(/MSIE (\d+)/)[1])===7&&!window.opera}catch(a){return!1}};return a()}(),gteIe7:function(){var a=function(){try{return!!navigator.userAgent.match(/Trident.*rv/)||parseInt(navigator.userAgent.match(/MSIE (\d+)/)[1])>=7&&!window.opera}catch(a){return!1}};return a()}(),ie8:function(){var a=function(){try{return parseInt(navigator.userAgent.match(/MSIE (\d+)/)[1])===8&&!window.opera}catch(a){return!1}};return a()}(),opera:Boolean(window.opera),chrome:Boolean(window.chrome),safari:Boolean(window.getComputedStyle&&!window.globalStorage&&navigator.userAgent.toLowerCase().indexOf("safari/")!==-1&&!/Chrome/.test(navigator.userAgent))},activeXEnabled:function(){var a;try{a=!!(new ActiveXObject("htmlfile"))}catch(b){a=!1}return a}(),name:function(){for(var a in this.is)if(this.is[a])return a},hasMimeType:function(a){for(var b=0,c=navigator.mimeTypes.length;b<c;b++)if(navigator.mimeTypes[b].type.indexOf(a)>-1)return!0;return!1}},reloadPlugins:function(){if(/msie/i.test(navigator.userAgent))throw"Plugin reload is not yet supported in IE";navigator.plugins.refresh()},isJavaBroken:function(a){var b,c,d;b=document.getElementById(a),d=!navigator.javaEnabled();if(!this.browser.is.safari)return!1;if(!b)return!1;if(d)return!0;c=parseInt(b.width);if(typeof c=="number"&&c>1)return!0;return!1},loadFile:function(a,b){if(b.toLowerCase()==="js"){var c=document.createElement("script");c.setAttribute("type","text/javascript"),c.setAttribute("src",a)}else if(b.toLowerCase()==="css"){var c=document.createElement("link");c.setAttribute("rel","stylesheet"),c.setAttribute("type","text/css"),c.setAttribute("href",a)}typeof c!="undefined"&&document.getElementsByTagName("head")[0].appendChild(c)},loadScript:function(a,b){var c=document.createElement("script");c.type="text/"+(a.type||"javascript"),c.src=a.src||a,c.onreadystatechange=c.onload=function(){var a=c.readyState;!b.done&&(!a||/loaded|complete/.test(a))&&(b.done=!0,b())},(document.body||head).appendChild(c)},parseSearchString:function(a){return unescape(window.location.search.replace(new RegExp("^(?:.*[&\\?]"+escape(a).replace(/[\.\+\*]/g,"\\$&")+"(?:\\=([^&]*))?)?.*$","i"),"$1"))},awAjax:function(a,b,c,d,e){e=this.ActiveXObject,e=new(e?e:XMLHttpRequest)("Microsoft.XMLHTTP"),e.open(d?"POST":"GET",a,c),e.setRequestHeader("Content-type","application/x-www-form-urlencoded"),e.onreadystatechange=function(){e.readyState>3&&b?b(e.responseText,e):0},e.send(d)},awStringify:function(j,d,t){if(d)return eval("("+j+")");if(!j)return j+"";t=[];if(j.pop){for(x in j)t.push(_.S(j[x]));j="["+t.join(",")+"]"}else if(typeof j=="object"){for(x in j)t.push(x+":"+_.S(j[x]));j="{"+t.join(",")+"}"}else j.split&&(j="'"+j.replace(/\'/g,"\\'")+"'");return j},JSON:function(){var JSON;window.JSON||(window.JSON={}),function(){function str(a,b){var c,d,e,f,g=gap,h,i=b[a];i&&typeof i=="object"&&typeof i.toJSON=="function"&&(i=i.toJSON(a)),typeof rep=="function"&&(i=rep.call(b,a,i));switch(typeof i){case"string":return quote(i);case"number":return isFinite(i)?String(i):"null";case"boolean":case"null":return String(i);case"object":if(!i)return"null";gap+=indent,h=[];if(Object.prototype.toString.apply(i)==="[object Array]"){f=i.length;for(c=0;c<f;c+=1)h[c]=str(c,i)||"null";e=h.length===0?"[]":gap?"[\n"+gap+h.join(",\n"+gap)+"\n"+g+"]":"["+h.join(",")+"]",gap=g;return e}if(rep&&typeof rep=="object"){f=rep.length;for(c=0;c<f;c+=1)typeof rep[c]=="string"&&(d=rep[c],e=str(d,i),e&&h.push(quote(d)+(gap?": ":":")+e))}else for(d in i)Object.prototype.hasOwnProperty.call(i,d)&&(e=str(d,i),e&&h.push(quote(d)+(gap?": ":":")+e));e=h.length===0?"{}":gap?"{\n"+gap+h.join(",\n"+gap)+"\n"+g+"}":"{"+h.join(",")+"}",gap=g;return e}}function quote(a){escapable.lastIndex=0;return escapable.test(a)?'"'+a.replace(escapable,function(a){var b=meta[a];return typeof b=="string"?b:"\\u"+("0000"+a.charCodeAt(0).toString(16)).slice(-4)})+'"':'"'+a+'"'}function f(a){return a<10?"0"+a:a}typeof Date.prototype.toJSON!="function"&&(Date.prototype.toJSON=function(a){return isFinite(this.valueOf())?this.getUTCFullYear()+"-"+f(this.getUTCMonth()+1)+"-"+f(this.getUTCDate())+"T"+f(this.getUTCHours())+":"+f(this.getUTCMinutes())+":"+f(this.getUTCSeconds())+"Z":null},String.prototype.toJSON=Number.prototype.toJSON=Boolean.prototype.toJSON=function(a){return this.valueOf()});var cx=/[\u0000\u00ad\u0600-\u0604\u070f\u17b4\u17b5\u200c-\u200f\u2028-\u202f\u2060-\u206f\ufeff\ufff0-\uffff]/g,escapable=/[\\\"\x00-\x1f\x7f-\x9f\u00ad\u0600-\u0604\u070f\u17b4\u17b5\u200c-\u200f\u2028-\u202f\u2060-\u206f\ufeff\ufff0-\uffff]/g,gap,indent,meta={"\b":"\\b","\t":"\\t","\n":"\\n","\f":"\\f","\r":"\\r",'"':'\\"',"\\":"\\\\"},rep;typeof window.JSON.stringify!="function"&&(window.JSON.stringify=function(a,b,c){var d;gap="",indent="";if(typeof c=="number")for(d=0;d<c;d+=1)indent+=" ";else typeof c=="string"&&(indent=c);rep=b;if(b&&typeof b!="function"&&(typeof b!="object"||typeof b.length!="number"))throw new Error("JSON.stringify");return str("",{"":a})}),typeof window.JSON.parse!="function"&&(window.JSON.parse=function(text,reviver){function walk(a,b){var c,d,e=a[b];if(e&&typeof e=="object")for(c in e)Object.prototype.hasOwnProperty.call(e,c)&&(d=walk(e,c),d!==undefined?e[c]=d:delete e[c]);return reviver.call(a,b,e)}var j;text=String(text),cx.lastIndex=0,cx.test(text)&&(text=text.replace(cx,function(a){return"\\u"+("0000"+a.charCodeAt(0).toString(16)).slice(-4)}));if(/^[\],:{}\s]*$/.test(text.replace(/\\(?:["\\\/bfnrt]|u[0-9a-fA-F]{4})/g,"@").replace(/"[^"\\\n\r]*"|true|false|null|-?\d+(?:\.\d*)?(?:[eE][+\-]?\d+)?/g,"]").replace(/(?:^|:|,)(?:\s*\[)+/g,""))){j=eval("("+text+")");return typeof reviver=="function"?walk({"":j},""):j}throw new SyntaxError("JSON.parse")})}()}()},Function.prototype.bind||(Function.prototype.bind=function(a){if(typeof this!="function")throw new TypeError("Function.prototype.bind - what is trying to be bound is not callable");var b=Array.prototype.slice.call(arguments,1),c=this,d=function(){},e=function(){return c.apply(this instanceof d&&a?this:a,b.concat(Array.prototype.slice.call(arguments)))};d.prototype=this.prototype,e.prototype=new d;return e});if(!AW.utils.console){AW.utils.console=window.console?window.console:{};var fns=["assert","count","debug","dir","dirxml","error","group","groupCollapsed","groupEnd","info","log","markTimeline","profile","profileEnd","time","timeEnd","timeStamp","trace","warn"];for(var i=0;i<fns.length;i++)AW.utils.console[fns[i]]||(AW.utils.console[fns[i]]=function(){})}AW.Connect=function(a){function R(){N.awPlugin&&(N.domEventsNotSupported()&&(N.awPlugin.style.width="0px",N.awPlugin.style.height="0px"),N.awPlugin.parentNode.style.width="0px",N.awPlugin.parentNode.style.height="0px")}function Q(a,b){N.domEventsNotSupported()?(a.parentNode.style.position="fixed",a.parentNode.style.width=b.offsetWidth+"px",a.parentNode.style.height=b.offsetHeight+"px",a.parentNode.style.top=b.getBoundingClientRect().top+"px",a.parentNode.style.left=b.getBoundingClientRect().left+"px",a.style.position="absolute",a.style.width=b.offsetWidth+"px",a.style.height=b.offsetHeight+"px",a.style.top="0px",a.style.left="0px"):(a.parentNode.style.position="fixed",a.parentNode.style.width=b.offsetWidth+"px",a.parentNode.style.height=b.offsetHeight+"px",a.parentNode.style.top=b.getBoundingClientRect().top+"px",a.parentNode.style.left=b.getBoundingClientRect().left+"px")}function P(a,b){O(b);if(N.currentTarget!=(b.currentTarget||b.srcElement)){N.awPlugin=document.getElementById(a);if(N.domEventsNotSupported())if(AW.utils.browser.is.ie){var c=function(){p!=0&&(clearTimeout(p),p=0,document.removeEventListener?N.awPlugin.parentNode.removeEventListener("dragover",d):N.awPlugin.parentNode.detachEvent("ondragover",d),R(),L("dragleave",null,N.currentTarget),N.currentTarget=null)},d=function(){clearTimeout(p),p=0,p=setTimeout(c,200)};N.currentTarget&&c(),document.addEventListener?N.awPlugin.parentNode.addEventListener("dragover",d,!1):N.awPlugin.parentNode.attachEvent("ondragover",d),p=setTimeout(c,200)}else{var e=function(){p!=0&&(clearTimeout(p),p=0,n.removeEventListener("dragover",d),R(),L("dragleave",null,N.currentTarget),N.currentTarget=null)},d=function(){clearTimeout(p),p=0,p=setTimeout(e,200)};N.currentTarget&&e(),n.addEventListener("dragover",d),p=setTimeout(e,200)}else{var f=function(){p!=0&&(clearTimeout(p),p=0,document.removeEventListener&&!N.domEventsNotSupported()?N.awPlugin.parentNode.removeEventListener("dragover",d):N.domEventsNotSupported()||N.awPlugin.parentNode.detachEvent("ondragover",d),R(),L("dragleave",null,N.currentTarget),N.currentTarget=null)},d=function(){clearTimeout(p),p=0,p=setTimeout(f,200)};N.currentTarget&&f(),document.addEventListener?N.awPlugin.parentNode.addEventListener("dragover",d,!1):N.awPlugin.parentNode.attachEvent("ondragover",d),p=setTimeout(f,200)}L("dragenter",null,this),N.currentTarget=this,Q(N.awPlugin,this)}}function O(a){if(!a)var a=window.event;a.cancelBubble=!0,a.returnValue=!1,a.stopPropagation&&a.stopPropagation(),a.preventDefault&&a.preventDefault();return!1}function M(a,b,c){var e,f,g,h;h=!(a!=="drop"&&a!=="dropex"||!N.currentTarget),e=C(b);if(h)R(),L(a,e,N.currentTarget);else{if(a==="dragleave"){(N.domEventsSupported()||AW.utils.browser.is.ie)&&L(a,null,N.currentTarget);return}if(a!==d.TRANSFER){L(a,e);return}g=e.transfers;for(f=0;f<g.length;f++)L(d.TRANSFER,g[f]);i=!0}}function L(a,b,c){var e,f,g;for(f=0;f<m.length;f++)try{g=m[f][0],e=m[f][1],(g===a||g===d.ALL)&&(!m[f][2]||i)&&e(a,b,c)}catch(h){AW.utils.console.error(h.name+": "+h.message),AW.utils.console.trace()}}function K(a){var b,d,e,f,g,h,i,j;document.getElementById(a.id)===null&&(i=a.width,g=a.height,h=a.image,f=o&&a.dropMode!==c.DISABLED,f&&(i=0,g=0,h=""),j=document.createElement("div"),j.style.position="relative",j.style.height=g+"px",j.style.width=i+"px",a.dropMode===c.DISABLED&&(j.style.overflow="hidden"),b=document.getElementById(a.containerId),b===null?document.body.appendChild(j):b.appendChild(j),d="\n",d+='<object id="'+a.id+'" type="application/x-aspera-web" width="'+i+'" height="'+g+'" style="position:absolute; top:0px; left:0px;">',d+='<param name="connect-launch-wait-timeout-ms" value="'+a.connectLaunchWaitTimeoutMs+'">',d+='<param name="image" value="'+h+'">',d+='<param name="link-capacity" value="'+a.linkCapacityKbps+'">',d+='<param name="drop-mode" value="'+a.dropMode+'">',a.transparent==="yes"?d+='<param name="transparent" value="yes">':d+='<param name="transparent" value="no">',a.dropMode===c.UPLOAD&&(d+='<param name="drop-upload-url" value="'+a.dropUploadUrl+'">'),a.dropMode!==c.DISABLED&&(d+='<param name="drop-allow-directories" value="'+a.dropAllowDirectories+'">',d+='<param name="drop-allow-multiple" value="'+a.dropAllowMultiple+'">'),d+="</object>\n",a.imageCover.length!==0&&AW.utils.browser.is.ie&&(e=a.id+"-cover",d+='<img id="'+e+'" src="'+a.imageCover+'" style="position:absolute; top:0px; left:0px;"'+" onClick=\"document.getElementById('"+e+"').style.display='none';\"/>\n"),j.innerHTML=d,f&&G(a),n.plugin=function(){return document.getElementById(a.id)})}function J(a,b,c,d){return I(a,b,c,d)}function I(b,c,d,e){var f,g;y(d)&&(d={}),H(d),a.authorizationKey.length>0&&(d.authorization_key=a.authorizationKey),f=JSON.stringify(d),t(e)?g=F().connectHttpRequestAsync(b,c,f,E(e)):g=F().connectHttpRequest(b,c,f);return C(g)}function H(a){A(a.aspera_connect_settings)&&(a.aspera_connect_settings={}),a.aspera_connect_settings.app_id=h}function G(a){function e(a){a.stopPropagation&&a.stopPropagation(),a.preventDefault&&a.preventDefault();var c=a.dataTransfer.files,d=[];for(var e=0;e<c.length;e++)d.push(c[e].name);b.handleDrop(d);return!1}function d(a){a.preventDefault&&a.preventDefault();return!1}var b,c;b=F(),c=b.parentNode,c.style.width=a.width+"px",c.style.height=a.height+"px",a.image.length!==0&&(c.style.background="transparent url("+a.image+") 0 0 no-repeat"),document.addEventListener?c.addEventListener("dragover",d,!1):c.attachEvent("ondragover",d),document.addEventListener?c.addEventListener("drop",e,!1):c.attachEvent("ondrop",e)}function F(){return document.getElementById(k)}function E(a){return D(function(){var b,c;try{b=Array.prototype.slice.call(arguments);for(c=0;c<b.length;c++)if(w(b[c])&&t(b[c].error)){t(a.error)&&a.error.apply(null,b);return}t(a.success)&&a.success.apply(null,b)}catch(d){AW.utils.console.error(d.name+": "+d.message),AW.utils.console.trace()}})}function D(a){return function(){var b,c;try{b=Array.prototype.slice.call(arguments);for(c=0;c<b.length;c++)b[c]=C(b[c]);a.apply(null,b)}catch(d){AW.utils.console.error(d.name+": "+d.message),AW.utils.console.trace()}}}function C(a){var b;if(typeof a=="string"&&(a.length===0||a.replace(/\s/g,"")==="{}"))return null;try{b=JSON.parse(a)}catch(c){b={},r(b,c,'Failed to parse "'+a+'"')}return b}function B(a,b){var c,d;d=t(b)?a+b:a,c=document.getElementById(d),c!==null&&(d=B(a,t(b)?b+1:2));return d}function A(a){return typeof a=="undefined"}function z(a){return a===""||y(a)}function y(a){return a===null||typeof a=="undefined"}function x(a){return!isNaN(parseFloat(a))&&isFinite(a)}function w(a){return a!==null&&typeof a=="object"}function v(a){return typeof a=="object"}function u(a){var b=null;for(b in a)if(a.hasOwnProperty(b))return!1;return!0}function t(a){return typeof a!="undefined"}function s(){var a=(new Date).getTime();return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(b){var c=((a+16)*Math.random()).toFixed()%16;b!=="x"&&(c=c&3|8);return c.toString(16)})}function r(a,b,c){q(a,arguments.length<3?b.message:c),a.error.internal_info=b}function q(a,b){a.error={code:-1,user_message:b}}"use strict";var b,c,d,e,f,g,h,i,j,k,l,m,n,o,p;AW.Connect.EVENT={ALL:"all",DRAGENTER:"dragenter",DRAGLEAVE:"dragleave",DROP:"drop",DROPEX:"dropex",TRANSFER:"transfer"},AW.Connect.TRANSFER_STATUS={CANCELLED:"cancelled",COMPLETED:"completed",FAILED:"failed",INITIATING:"initiating",QUEUED:"queued",REMOVED:"removed",RUNNING:"running",WILLRETRY:"willretry"},AW.Connect.DROP_MODE={CALLBACK:"callback",DISABLED:"disabled",UPLOAD:"upload"},b=4,c=AW.Connect.DROP_MODE,d=AW.Connect.EVENT,e={GET:"GET",POST:"POST"},f=AW.Connect.TRANSFER_STATUS,g="/v"+b,n=this,j=window.location.hostname,j===""&&(j="localhost"),h="^"+j,m=[],i=!1,l=function(){function b(b,c){c=c||document.createElement(a[b]||"div"),b="on"+b;var d=typeof c.eventName!="undefined";d||(c.setAttribute||(c=document.createElement("div")),c.setAttribute&&c.removeAttribute&&(c.setAttribute(b,""),d=typeof c[b]=="function",typeof c[b]!="undefined"&&(c[b]=undefined),c.removeAttribute(b))),c=null;return d}var a={select:"input",change:"input",submit:"form",reset:"form",error:"img",load:"img",abort:"img"};return b}(),o=function(){return/Mac/.test(navigator.platform)&&!/Mac OS X 10[._]4/.test(navigator.userAgent)&&!/PPC/.test(navigator.platform)&&!/Linux/.test(navigator.platform)&&l("dragstart")&&l("drop")}(),A(a)&&(a={}),A(a.authorizationKey)&&(a.authorizationKey=""),A(a.connectLaunchWaitTimeoutMs)&&(a.connectLaunchWaitTimeoutMs=2e4),A(a.containerId)&&(a.containerId=B("aspera_connect_object_container")),A(a.dropAllowDirectories)&&(a.dropAllowDirectories=!0),A(a.dropAllowMultiple)&&(a.dropAllowMultiple=!0),A(a.dropMode)&&(a.dropMode=c.DISABLED),A(a.dropUploadUrl)&&(a.dropUploadUrl=""),A(a.height)&&(a.height=1),A(a.id)&&(a.id="aspera-web"),A(a.image)&&(a.image=""),A(a.imageCover)&&(a.imageCover=""),A(a.linkCapacityKbps)&&(a.linkCapacityKbps=0),A(a.width)&&(a.width=1),k=a.id;var N={currentTarget:null,get:function(){document.querySelectorAll||function(a,b){a=document,b=a.createStyleSheet(),a.querySelectorAll=function(c,d,e,f,g){g=a.all,d=[],c=c.replace(/\[for\b/gi,"[htmlFor").split(",");for(e=c.length;e--;){b.addRule(c[e],"k:v");for(f=g.length;f--;)g[f].currentStyle.k&&d.push(g[f]);b.removeRule(0)}return d}}();return document.querySelectorAll(N.selector)},domEventsNotSupported:function(){return!this.domEventsSupported()},domEventsSupported:function(){var a,b;a=AW.utils.browser.is,b=navigator.platform.indexOf("Mac")>-1;return b&&a.ff||b&&a.chrome||b&&a.safari},awPlugin:undefined};this.setDropTargets=function(a){var b;if(AW.utils.versionLessThan(this.plugin().queryBuildVersion(),"3.4"))throw new Error("This version of Aspera Connect does not support advanced drag and drop features. Please upgrade to version 3.4 or later. http://asperasoft.com/connect");N.selector=a,document.querySelectorAll||function(a,b){a=document,b=a.createStyleSheet(),a.querySelectorAll=function(c,d,e,f,g){g=a.all,d=[],c=c.replace(/\[for\b/gi,"[htmlFor").split(",");for(e=c.length;e--;){b.addRule(c[e],"k:v");for(f=g.length;f--;)g[f].currentStyle.k&&d.push(g[f]);b.removeRule(0)}return d}}(),b=document.querySelectorAll(N.selector);for(var c=0,d=b.length;c<d;c++)document.addEventListener?b[c].addEventListener("dragenter",P.bind(b[c],this.plugin().id),!1):b[c].attachEvent("ondragenter",P.bind(b[c],this.plugin().id));b.length&&(N.awPlugin=document.getElementById(this.plugin().id),R());return N.get()},this.getDropTargets=function(){return N.get()},this.addEventListener=function(a,b,c){A(c)&&(c=!1),m.push([a,b,c]);return null},this.authenticate=function(a,b){return J(e.POST,g+"/connect/authenticate",a,b)},this.getAllTransfers=function(a){var b={};arguments.length>0&&(b.iteration_token=a);return I(e.POST,g+"/transfers/activity",b)},this.initSession=function(a){var b,c;z(a)||(h=a),b=F(),c=b.initSession(h,j),b.eventHandler=function(a,b){M(a,b)};return c},this.modifyTransfer=function(a,b){return I(e.POST,g+"/transfers/modify/"+a,b)},this.readAsArrayBuffer=function(a){if(!n.plugin())throw new Error("Unable to find the aspera-web plugin");return n.plugin().readAsArrayBuffer(a)},this.readChunkAsArrayBuffer=function(a){if(F()){if(!a.path||!a.offset||!a.chunkSize)throw new Error("Invalid parameters");console.log(a.offset),console.log(a.chunkSize);return F().readChunkAsArrayBuffer(a.path,a.offset,a.chunkSize)}throw new Error("Unable to find the aspera-web plugin")},this.removeEventListener=function(a,b){var c,d,e;for(c=0;c<m.length;c++)e=m[c][0],d=m[c][1],(!a&&!b||e===a&&!b||d===b&&!a||d===b&&e===a)&&m.splice(c,1);return null},this.removeTransfer=function(a){return I(e.POST,g+"/transfers/remove/"+a)},this.resumeTransfer=function(a,b){return I(e.POST,g+"/transfers/resume/"+a,b)},this.showAbout=function(){return I(e.GET,g+"/windows/about")},this.showDirectory=function(a){return I(e.GET,g+"/windows/finder/"+a)},this.showPreferences=function(){return I(e.GET,g+"/windows/preferences")},this.showSaveFileDialog=function(a,b){var c;A(b)&&(b={}),A(b.title)&&(b.title=""),A(b.suggestedName)&&(b.suggestedName=""),A(b.allowedFileTypes)?b.allowedFileTypes="":b.allowedFileTypes=JSON.stringify(b.allowedFileTypes),c=F().runSaveFileDialogAsync(b.title,b.suggestedName,b.allowedFileTypes,E(a));return z(c)?null:c},this.showSelectFileDialog=function(a,b){var c;A(b)&&(b={}),A(b.title)&&(b.title=""),A(b.allowMultipleSelection)&&(b.allowMultipleSelection=!0),A(b.allowedFileTypes)?b.allowedFileTypes="":b.allowedFileTypes=JSON.stringify(b.allowedFileTypes),A(b.extendedInfo)&&(b.extendedInfo=!1),AW.utils.versionLessThan(this.version().connect.version,"3.4.1")?c=F().runOpenFileDialogAsync(b.title,b.allowMultipleSelection,b.allowedFileTypes,E(a)):c=F().runOpenFileDialogAsync(b.title,b.allowMultipleSelection,b.allowedFileTypes,E(a),b.extendedInfo);return z(c)?null:c},this.showSelectFolderDialog=function(a,b){var c;A(b)&&(b={}),A(b.title)&&(b.title=""),A(b.allowMultipleSelection)&&(b.allowMultipleSelection=!0),A(b.extendedInfo)&&(b.extendedInfo=!1),AW.utils.versionLessThan(this.version().connect.version,"3.4.1")?c=F().runOpenFolderDialogAsync(b.title,b.allowMultipleSelection,E(a)):c=F().runOpenFolderDialogAsync(b.title,b.allowMultipleSelection,E(a),b.extendedInfo);return z(c)?null:c},this.showTransferManager=function(){return I(e.GET,g+"/windows/transfer-manager")},this.showTransferMonitor=function(a){return I(e.GET,g+"/windows/transfer-monitor/"+a)},this.startTransfer=function(a,b,c){var d;b=b||{},c=c||{},d={transfer_specs:[{transfer_spec:a,aspera_connect_settings:b}]};return this.startTransfers(d,c)},this.startTransfers=function(a,b){var c,d,f,h;b=b||{},d=s();for(c=0;c<a.transfer_specs.length;c++)h=a.transfer_specs[c],H(h),h.aspera_connect_settings.request_id=d,A(h.aspera_connect_settings.back_link)&&(h.aspera_connect_settings.back_link=window.location.href);f=J(e.POST,g+"/transfers/start",a,b),f===null&&(f={request_id:d});return f},this.stopTransfer=function(a){return I(e.POST,g+"/transfers/stop/"+a)},this.version=function(){var a,b,c,d,e;e={connect:{installed:!1,version:"Not installed"},plugin:{installed:!1,version:"Not installed"}},a=F();try{c=a.queryConnectVersion()}catch(f){r(e,f,"Plugin install required");return e}try{b=a.queryPluginVersion()}catch(g){e.connect.installed=!0,e.connect.version=c,e.plugin.installed=!0,e.plugin.version=c,r(e,g,"Plugin update required");return e}d=C(c),d.error?e.error=d.error:(e.connect.installed=!0,e.connect.version=d.release_version),e.plugin.installed=!0,e.plugin.version=b;return e},K(a)};